[env]
_.python.venv = { path = ".venv", create = true }

[tasks.setup]
run = "pip install -r requirements.txt && cp env.template .env && ${EDITOR:-nano} .env"
description = "Install dependencies, setup environment, and open .env for editing"

[tasks.engage]
run = "python -m src.main workflow"
description = "Run the full workflow"

[tasks.export]
run = "DRIVE=$(gum choose --header 'Select drive to export to' $(lsblk --noheadings --raw -o NAME,SIZE,TYPE,MOUNTPOINT | grep 'part' | awk '{print \"/dev/\" $1 \"\"}' | grep -v 'loop')) && echo '📁 Selected USB drive: $DRIVE' && sudo mkdir -p /mnt/usb && echo '📂 Created mount point' && sudo mount $DRIVE /mnt/usb && echo '🔗 Mounted USB drive' && sudo cp build/wipe_report_*.pdf /mnt/usb && echo '📄 Copied PDF reports' && sudo cp build/wipe_report_*.json /mnt/usb && echo '📋 Copied JSON reports' && sudo umount /mnt/usb && echo '✅ Export completed successfully!'"
description = "Export the report to a USB drive"

[tasks.cleanup]
run = "rm -rf build/*.pdf && rm -rf build/*.json"
description = "Cleanup the build directory"